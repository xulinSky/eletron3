"use strict";(self.webpackChunkvue2_project=self.webpackChunkvue2_project||[]).push([[90],{3090:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"eletron-page"},[t("el-card",{staticClass:"toolbar",attrs:{shadow:"never"}},[t("el-row",{attrs:{type:"flex",justify:"space-between",align:"middle"}},[t("el-col",{attrs:{span:12}},[t("h1",[e._v("Eletron - ÂõæÂΩ¢ÁºñËæëÂô®")])]),e._v(" "),t("el-col",{staticClass:"toolbar-actions",attrs:{span:12}},[t("div",{staticClass:"actions-wrapper"},[t("div",{staticClass:"file-controls"},[t("el-input",{attrs:{placeholder:"ËæìÂÖ•Êñá‰ª∂Âêç"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.saveFile.apply(null,arguments)}},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}}),e._v(" "),t("el-button",{attrs:{type:"primary",icon:"el-icon-check"},on:{click:e.saveFile}},[e._v("‰øùÂ≠ò")]),e._v(" "),t("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.clearGraph}},[e._v("Ê∏ÖÁ©∫")])],1)])])],1)],1),e._v(" "),t("div",{staticClass:"main-content"},[t("div",{staticClass:"canvas-area"},[t("div",{ref:"graphContainer",staticClass:"graph-container",attrs:{tabindex:"0"},on:{keydown:e.handleKeyDown}}),e._v(" "),t("div",{staticClass:"canvas-overlay canvas-overlay--left"},[t("div",{staticClass:"zoom-controls"},[t("el-button-group",{attrs:{size:"mini"}},[t("el-button",{attrs:{icon:"el-icon-refresh",circle:""},on:{click:e.resetZoom}}),e._v(" "),t("el-button",{attrs:{icon:"el-icon-zoom-out",circle:""},on:{click:e.zoomOut}}),e._v(" "),t("el-button",{attrs:{icon:"el-icon-zoom-in",circle:""},on:{click:e.zoomIn}})],1),e._v(" "),t("span",{staticClass:"zoom-level"},[e._v(e._s(e.zoomLevel)+"%")])],1)]),e._v(" "),t("div",{staticClass:"canvas-overlay canvas-overlay--right"},[t("div",{ref:"miniMap",staticClass:"mini-map"})])]),e._v(" "),t("div",{staticClass:"sidebar"},[t("el-card",{staticClass:"component-library",attrs:{shadow:"hover"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("ÂÖÉÂô®Â∫ì")])]),e._v(" "),t("el-row",{staticClass:"component-list",attrs:{gutter:10}},e._l(e.componentLibrary,function(n){return t("el-col",{key:n.type,attrs:{span:8}},[t("el-card",{staticClass:"component-item",attrs:{shadow:"hover",draggable:!0},nativeOn:{dragstart:function(t){return e.handleDragStart(t,n)},click:function(t){return e.addComponentToCanvas(n)}}},[t("div",{staticClass:"component-content"},[t("div",{staticClass:"component-icon",style:{backgroundColor:n.color}},[e._v("\n                  "+e._s(n.icon)+"\n                ")]),e._v(" "),t("div",{staticClass:"component-name"},[e._v(e._s(n.name))])])])],1)}),1)],1),e._v(" "),t("el-card",{staticClass:"property-panel",attrs:{shadow:"hover"}},[t("div",{attrs:{slot:"header"},slot:"header"},[t("h3",[e._v("ÂÖÉÂô®Â±ûÊÄßÔºàÂèØÈù†ÊÄßÂèÇÊï∞Ôºâ")])]),e._v(" "),e.selectedCell?t("el-form",{attrs:{"label-width":"120px",size:"small"}},[t("el-form-item",{attrs:{label:"ÂêçÁß∞"}},[t("el-input",{on:{input:function(t){return e.updateCellProperty("value",t)}},model:{value:e.cellProperties.value,callback:function(t){e.$set(e.cellProperties,"value",t)},expression:"cellProperties.value"}})],1),e._v(" "),e._l(e.selectedComponentProps,function(n){return t("el-form-item",{key:n.key,attrs:{label:n.key}},["number"===n.type?[t("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,step:.01},on:{change:function(t){return e.updateComponentProp(n.key,n.value)}},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"prop.value"}})]:"select"===n.type?[t("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"ËØ∑ÈÄâÊã©"},on:{change:function(t){return e.updateComponentProp(n.key,n.value)}},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"prop.value"}},e._l(n.options,function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})}),1)]:[t("el-input",{on:{input:function(t){return e.updateComponentProp(n.key,n.value)}},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"prop.value"}})]],2)})],2):t("el-empty",{attrs:{description:"ËØ∑ÈÄâÊã©‰∏Ä‰∏™ÂÖÉÂô®Êù•ÁºñËæëÂ±ûÊÄß","image-size":80}})],1)],1)])],1)};a._withStripped=!0;var r=n(9504),o=n(3556),i=n(9866),l=n(9760);const s={diesel_gen:[{key:"ÊïÖÈöúÂÅúËøêÁéá(Ê¨°/Âè∞Âπ¥)",type:"number",default:0},{key:"ÊïÖÈöúÂÅúÁîµÂπ≥ÂùáÊåÅÁª≠Êó∂Èó¥(min/Ê¨°)",type:"number",default:0},{key:"Â§áÁî®ÂêØÂä®Êó∂Èó¥Ôºàmin/Ê¨°Ôºâ",type:"number",default:5},{key:"ÂêéÂ§á‰æõÁîµÊó∂Èó¥ÔºàminÔºâ",type:"number",default:720}],transformer:[{key:"ÊïÖÈöúÂÅúËøêÁéá(Ê¨°/Âè∞Âπ¥)",type:"number",default:.002},{key:"Âπ≥ÂùáÊïÖÈöú‰øÆÂ§çÊó∂Èó¥(min/Ê¨°)",type:"number",default:20},{key:"È¢ÑÂÆâÊéíÂÅúËøêÁéá(Ê¨°/Âè∞Âπ¥)",type:"number",default:0},{key:"È¢ÑÂÆâÊéíÂÅúËøêÂπ≥ÂùáÊåÅÁª≠Êó∂Èó¥(min/Ê¨°)",type:"number",default:0},{key:"ÊïÖÈöúÂÆö‰ΩçÊó∂Èó¥(min/Ê¨°)",type:"number",default:60}],busbar:[{key:"Âπ≥Ë°°Á±ªÂûã",type:"select",default:"Âπ≥Ë°°",options:["Âπ≥Ë°°","‰∏çÂπ≥Ë°°"]},{key:"ÊïÖÈöúÂÅúËøêÁéá(Ê¨°/Êù°Âπ¥)",type:"number",default:0},{key:"ÊïÖÈöúÂÅúÁîµÂπ≥ÂùáÊåÅÁª≠Êó∂Èó¥(min/Ê¨°)",type:"number",default:0},{key:"È¢ÑÂÆâÊéíÂÅúËøêÁéá(Ê¨°/Êù°Âπ¥)",type:"number",default:0},{key:"È¢ÑÂÆâÊéíÂÅúËøêÂπ≥ÂùáÊåÅÁª≠Êó∂Èó¥(min/Ê¨°)",type:"number",default:0},{key:"ÊïÖÈöúÂÆö‰ΩçÊó∂Èó¥(min/Ê¨°)",type:"number",default:60}],switch:[{key:"ÊïÖÈöúÂÅúËøêÁéá(Ê¨°/Âè∞Âπ¥)",type:"number",default:.0012},{key:"Âπ≥ÂùáÊïÖÈöú‰øÆÂ§çÊó∂Èó¥(min/Ê¨°)",type:"number",default:240},{key:"ËÅîÁªúÂºÄÂÖ≥",type:"select",default:"Âê¶",options:["Âê¶","ÊòØ"]},{key:"È¶àÁ∫øÂºÄÂÖ≥",type:"select",default:"Âê¶",options:["Âê¶","ÊòØ"]},{key:"È¢ÑÂÆâÊéíÂÅúËøêÁéá(Ê¨°/Âè∞Âπ¥)",type:"number",default:0},{key:"È¢ÑÂÆâÊéíÂÅúËøêÂπ≥ÂùáÊåÅÁª≠Êó∂Èó¥(min/Ê¨°)",type:"number",default:0},{key:"ÊïÖÈöúÂÆö‰ΩçÊó∂Èó¥(min/Ê¨°)",type:"number",default:60},{key:"ÂºÄÂÖ≥ÊïÖÈöúÂä®‰ΩúÊó∂Èó¥(min/Ê¨°)",type:"number",default:20},{key:"ÂºÄÂÖ≥È¢ÑÂÆâÊéíÂÅúÁîµÈöîÁ¶ªÊó∂Èó¥(min/Ê¨°)",type:"number",default:20},{key:"Ëá™Âä®ÂºÄÂÖ≥ÊïÖÈöúÈáçÂêàÈó∏Êó∂Èó¥(min/Ê¨°)",type:"number",default:30},{key:"Ëá™Âä®ÂºÄÂÖ≥È¢ÑÂÆâÊéíÈáçÂêàÈó∏Êó∂Èó¥(min/Ê¨°)",type:"number",default:10},{key:"ËΩ¨‰æõÁ∫øË∑ØÂäüÁéá‰ΩôÈáè(MW)",type:"number",default:-1},{key:"È¢ÑÂÆâÊéíËΩ¨‰æõÁ∫øË∑ØÂäüÁéá‰ΩôÈáè(MW)",type:"number",default:-1}],line:[{key:"ÊïÖÈöúÂÅúËøêÁéá(Ê¨°/ÁôæÂÖ¨Èáå*Âπ¥)",type:"number",default:.04},{key:"Âπ≥ÂùáÊïÖÈöú‰øÆÂ§çÊó∂Èó¥(min/Ê¨°)",type:"number",default:240},{key:"È¢ÑÂÆâÊéíÂÅúËøêÁéá(Ê¨°/ÁôæÂÖ¨Èáå*Âπ¥)",type:"number",default:.06},{key:"È¢ÑÂÆâÊéíÂÅúËøêÂπ≥ÂùáÊåÅÁª≠Êó∂Èó¥(min/Ê¨°)",type:"number",default:300},{key:"ÊïÖÈöúÂÆö‰ΩçÊó∂Èó¥(min/Ê¨°)",type:"number",default:60}],ups:[{key:"ÊïÖÈöúÂÅúËøêÁéá(Ê¨°/Âè∞Âπ¥)",type:"number",default:.0876},{key:"Âπ≥ÂùáÊïÖÈöú‰øÆÂ§çÊó∂Èó¥(min/Ê¨°)",type:"number",default:240},{key:"ËøêË°åÊ®°Âºè",type:"select",default:"Âú®Á∫øÂèåÂèòÊç¢Ê®°Âºè",options:["Âú®Á∫øÂèåÂèòÊç¢Ê®°Âºè","ECOÊ®°Âºè"]},{key:"ÊóÅË∑ØÈÄÜÂèòËΩ¨Êç¢ÊïÖÈöúÂä®‰ΩúÊó∂Èó¥Ôºàmin/Ê¨°Ôºâ",type:"number",default:0},{key:"ECOÊ®°ÂºèËΩ¨Êç¢ÊïÖÈöúÂä®‰ΩúÊó∂Èó¥Ôºàmin/Ê¨°Ôºâ",type:"number",default:0},{key:"ÊïÖÈöúÂÆö‰ΩçÊó∂Èó¥(min/Ê¨°)",type:"number",default:30},{key:"ÂêéÂ§á‰æõÁîµÊó∂Èó¥ÔºàminÔºâ",type:"number",default:15}],ats:[{key:"ÊïÖÈöúÂÅúËøêÁéá(Ê¨°/Âè∞Âπ¥)",type:"number",default:.0012},{key:"Âπ≥ÂùáÊïÖÈöú‰øÆÂ§çÊó∂Èó¥(min/Ê¨°)",type:"number",default:240},{key:"ATSÊïÖÈöúÂä®‰ΩúÊó∂Èó¥Ôºàmin/Ê¨°Ôºâ",type:"number",default:0},{key:"ÊïÖÈöúÂÆö‰ΩçÊó∂Èó¥(min/Ê¨°)",type:"number",default:30}],sts:[{key:"ÊïÖÈöúÂÅúËøêÁéá(Ê¨°/Âè∞Âπ¥)",type:"number",default:.0012},{key:"Âπ≥ÂùáÊïÖÈöú‰øÆÂ§çÊó∂Èó¥(min/Ê¨°)",type:"number",default:240},{key:"STSÊïÖÈöúÂä®‰ΩúÊó∂Èó¥Ôºàmin/Ê¨°Ôºâ",type:"number",default:0},{key:"ÊïÖÈöúÂÆö‰ΩçÊó∂Èó¥(min/Ê¨°)",type:"number",default:30}],load:[{key:"Â§öÁîµÊ∫êË¥üËç∑",type:"select",default:"ÊòØ",options:["ÊòØ","Âê¶"]},{key:"Ë¥üËç∑Â§áËá™ÊäïÂàáÊó∂Èó¥(min/Ê¨°)",type:"number",default:0}]},d={name:"Eletron",data:()=>({graph:null,selectedCell:null,selectedComponentType:null,selectedComponentProps:[],cellProperties:{value:"",width:120,height:60,fillColor:"#E3F2FD",strokeColor:"#1976D2",strokeWidth:2,arcSize:10},componentLibrary:[{type:"mains",name:"Â∏ÇÁîµ",icon:"‚ö°",color:"#E3F2FD",defaultStyle:{shape:"rectangle"},props:[]},{type:"diesel_gen",name:"Êü¥Ê≤πÂèëÁîµÊú∫",icon:"‚õΩ",color:"#E8F5E9",defaultStyle:{shape:"rectangle"},props:s.diesel_gen},{type:"transformer",name:"ÂèòÂéãÂô®",icon:"üîå",color:"#FFF3E0",defaultStyle:{shape:"rectangle"},props:s.transformer},{type:"busbar",name:"ÊØçÁ∫ø",icon:"‚ïê",color:"#F3E5F5",defaultStyle:{shape:"rectangle"},props:s.busbar},{type:"switch",name:"ÂºÄÂÖ≥",icon:"‚èª",color:"#FFEBEE",defaultStyle:{shape:"rectangle"},props:s.switch},{type:"line",name:"Á∫øË∑Ø",icon:"‚Äî",color:"#E3F2FD",defaultStyle:{shape:"rectangle"},props:s.line},{type:"connector",name:"ËøûÊé•Á∫øË∑Ø",icon:"‚ü∑",color:"#E3F2FD",defaultStyle:{shape:"rectangle"},props:[]},{type:"pv",name:"ÂÖâ‰ºè",icon:"‚òÄÔ∏è",color:"#FFF3E0",defaultStyle:{shape:"rectangle"},props:[]},{type:"wind",name:"È£éÊú∫",icon:"üåÄ",color:"#E8F5E9",defaultStyle:{shape:"rectangle"},props:[]},{type:"storage",name:"ÂÇ®ËÉΩ",icon:"üîã",color:"#F3E5F5",defaultStyle:{shape:"rectangle"},props:[]},{type:"ups",name:"UPS",icon:"üîå",color:"#E3F2FD",defaultStyle:{shape:"rectangle"},props:s.ups},{type:"ats",name:"ATS",icon:"üîÄ",color:"#FFF3E0",defaultStyle:{shape:"rectangle"},props:s.ats},{type:"sts",name:"STS",icon:"‚ÜîÔ∏è",color:"#FFEBEE",defaultStyle:{shape:"rectangle"},props:s.sts},{type:"reactor",name:"Êó†ÂäüË°•ÂÅøÂô®",icon:"‚àø",color:"#E3F2FD",defaultStyle:{shape:"rectangle"},props:[]},{type:"load",name:"Ë¥üËç∑",icon:"üè†",color:"#E8F5E9",defaultStyle:{shape:"rectangle"},props:s.load}],dragOffset:null,isDraggingOver:!1,handleGlobalKeyDownBound:null,handleGlobalKeyUpBound:null,fileName:"",fileId:null,zoomLevel:100,mouseWheelHandler:null,graphContainer:null,isSpacePressed:!1,miniMap:null}),mounted(){this.initGraph(),this.handleGlobalKeyDownBound=this.handleGlobalKeyDown.bind(this),document.addEventListener("keydown",this.handleGlobalKeyDownBound),this.handleGlobalKeyUpBound=this.handleGlobalKeyUp.bind(this),document.addEventListener("keyup",this.handleGlobalKeyUpBound),this.$nextTick(()=>{const e=this.$route.params.fileId;e&&this.loadFileById(e)})},beforeDestroy(){this.handleGlobalKeyDownBound&&document.removeEventListener("keydown",this.handleGlobalKeyDownBound),this.handleGlobalKeyUpBound&&document.removeEventListener("keyup",this.handleGlobalKeyUpBound),this.graphContainer&&this.mouseWheelHandler&&this.graphContainer.removeEventListener("wheel",this.mouseWheelHandler),this.graph&&this.graph.destroy(),this.miniMap&&"function"==typeof this.miniMap.destroy&&this.miniMap.destroy(),this.miniMap=null,this.graphContainer=null,this.mouseWheelHandler=null},methods:{initGraph(){const e=this.$refs.graphContainer;if(!e)return;if(r.A.disableContextMenu(e),this.graph=new o.T(e),this.graphContainer=e,this.graph.centerZoom=!0,this.graph.setPanning(!0),this.graph.panningHandler){const e=this.graph.panningHandler;e.useLeftButtonForPanning=!0;const t=e.isPanningTrigger?e.isPanningTrigger.bind(e):null;e.isPanningTrigger=e=>{const n=e.getEvent();if(this.isSpacePressed)return!0;const a="function"==typeof r.A.isMiddleMouseButton?r.A.isMiddleMouseButton(n):1===n.button,o="function"==typeof r.A.isRightMouseButton?r.A.isRightMouseButton(n):2===n.button;return!(!a&&!o)||!!t&&t(e)}}this.graph.setConnectable(!0),this.graph.setCellsMovable(!0);const t=this.graph.getStylesheet().getDefaultVertexStyle();t.shape="rectangle",t.fillColor="#E3F2FD",t.strokeColor="#1976D2",t.strokeWidth=2,t.arcSize=10;const n=this.graph.getStylesheet().getDefaultEdgeStyle();n.edgeStyle="orthogonalEdgeStyle",n.rounded=!0,n.strokeColor="#333",n.strokeWidth=2,n.endArrow="classic",n.endFill=1,this.graph.getSelectionModel().addListener("change",()=>{this.handleSelectionChange()}),e.addEventListener("dragover",this.handleDragOver.bind(this)),e.addEventListener("drop",this.handleDrop.bind(this)),e.addEventListener("dragenter",this.handleDragEnter.bind(this)),e.addEventListener("dragleave",this.handleDragLeave.bind(this)),this.mouseWheelHandler=this.handleMouseWheel.bind(this),e.addEventListener("wheel",this.mouseWheelHandler,{passive:!1}),e.setAttribute("tabindex","0"),this.updateZoomLevel(),this.updatePanningCursor(),this.initMiniMap()},initMiniMap(){const e=this.$refs.miniMap;e&&this.graph&&(e.innerHTML="",this.miniMap&&"function"==typeof this.miniMap.destroy&&this.miniMap.destroy(),this.miniMap=new i.A(this.graph,e),this.miniMap&&this.miniMap.outline&&(this.miniMap.outline.border=10),this.updateMiniMap(!0))},handleSelectionChange(){const e=this.graph.getSelectionCells();e.length>0&&e[0].isVertex()?(this.selectedCell=e[0],this.updatePropertyPanel()):this.selectedCell=null},updatePropertyPanel(){if(!this.selectedCell)return;const e=this.selectedCell.getGeometry(),t=this.selectedCell.getStyle();this.cellProperties={value:this.selectedCell.getValue()||"",width:e.width||120,height:e.height||60,fillColor:t.fillColor||"#E3F2FD",strokeColor:t.strokeColor||"#1976D2",strokeWidth:t.strokeWidth||2,arcSize:t.arcSize||0};const n=t.componentType,a=this.getComponentDef(n);a?(this.selectedComponentType=n,this.selectedComponentProps=a.props.map(e=>{const n=this.makePropKey(e.key),a=t[n];return{...e,value:void 0!==a?a:e.default}})):(this.selectedComponentType=null,this.selectedComponentProps=[])},updateCellProperty(e,t){this.selectedCell&&this.graph.batchUpdate(()=>{if("value"===e)this.selectedCell.setValue(t),this.graph.refresh(this.selectedCell);else if("width"===e||"height"===e){const n=this.selectedCell.getGeometry().clone();n[e]=t,this.graph.getDataModel().setGeometry(this.selectedCell,n)}})},zoomIn(){if(!this.graph)return;const e=this.graph.getView().getScale();this.applyZoom(1.1*e)},zoomOut(){if(!this.graph)return;const e=this.graph.getView().getScale();this.applyZoom(.9*e)},resetZoom(){this.graph&&(this.graph.view.setTranslate(0,0),this.applyZoom(1),this.centerGraphContent())},applyZoom(e){if(!this.graph)return;const t=Math.min(3,Math.max(.25,e));"function"==typeof this.graph.zoomTo?this.graph.zoomTo(t,!0):(this.graph.getView().setScale(t),this.graph.refresh()),this.updateZoomLevel(),this.updateMiniMap()},updateZoomLevel(){if(!this.graph)return;const e=this.graph.getView().getScale();this.zoomLevel=Math.round(100*e)},handleMouseWheel(e){if(!this.graph)return;e.preventDefault();const t=this.graph.getView().getScale(),n=e.deltaY<0?1.1:.9;this.applyZoom(t*n)},handleDragStart(e,t){e.dataTransfer.setData("component",JSON.stringify(t)),e.dataTransfer.effectAllowed="copy";const n=e.target.cloneNode(!0);n.style.position="absolute",n.style.top="-1000px",document.body.appendChild(n),e.dataTransfer.setDragImage(n,e.offsetX,e.offsetY),setTimeout(()=>document.body.removeChild(n),0),this.dragOffset={x:e.offsetX,y:e.offsetY}},handleDragEnter(e){e.preventDefault(),this.isDraggingOver=!0,this.$refs.graphContainer&&this.$refs.graphContainer.classList.add("drag-over")},handleDragOver(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},handleDragLeave(e){e.preventDefault(),this.$refs.graphContainer.contains(e.relatedTarget)||(this.isDraggingOver=!1,this.$refs.graphContainer&&this.$refs.graphContainer.classList.remove("drag-over"))},handleDrop(e){e.preventDefault(),e.stopPropagation(),this.isDraggingOver=!1,this.$refs.graphContainer&&this.$refs.graphContainer.classList.remove("drag-over");const t=e.dataTransfer.getData("component");if(t)try{const n=JSON.parse(t),a=this.$refs.graphContainer.getBoundingClientRect(),r=this.graph.getView(),o=r.getScale(),i=r.getTranslate(),l=(e.clientX-a.left)/o-i.x-60,s=(e.clientY-a.top)/o-i.y-30;this.createComponent(n,l,s)}catch(e){console.error("Failed to parse component data:",e)}},addComponentToCanvas(e){const t=this.$refs.graphContainer.getBoundingClientRect(),n=t.width/2-60,a=t.height/2-30;this.createComponent(e,n,a)},createComponent(e,t,n){this.graph.batchUpdate(()=>{const a={shape:e.defaultStyle.shape||"rectangle",fillColor:e.defaultStyle.fillColor||e.color,strokeColor:e.defaultStyle.strokeColor||"#D8D8D8",strokeWidth:e.defaultStyle.strokeWidth||2,arcSize:e.defaultStyle.arcSize||8,fontColor:"#1D2129",fontSize:16,componentType:e.type};e.props&&e.props.length&&e.props.forEach(e=>{a[this.makePropKey(e.key)]=e.default,"ÊñáÂ≠óÈ¢úËâ≤"===e.key&&(a.fontColor=e.default),"ËÉåÊôØËâ≤"===e.key&&(a.fillColor=e.default),"ËæπÊ°ÜÈ¢úËâ≤"===e.key&&(a.strokeColor=e.default),"ÂêçÁß∞Â≠ó‰ΩìÂ§ßÂ∞è(px)"===e.key&&(a.fontSize=e.default)});const r=this.graph.insertVertex({parent:this.graph.getDefaultParent(),value:e.name,position:[t,n],size:[120,60],style:a});this.graph.setSelectionCell(r)}),this.updateMiniMap(!0)},getComponentDef(e){return this.componentLibrary.find(t=>t.type===e)},makePropKey:e=>`prop_${e}`,updateComponentProp(e,t){this.selectedCell&&this.graph.batchUpdate(()=>{const n={...this.selectedCell.getStyle(),[this.makePropKey(e)]:t};"ÊñáÂ≠óÈ¢úËâ≤"===e?n.fontColor=t:"ËÉåÊôØËâ≤"===e?n.fillColor=t:"ËæπÊ°ÜÈ¢úËâ≤"===e?n.strokeColor=t:"ÂêçÁß∞Â≠ó‰ΩìÂ§ßÂ∞è(px)"===e&&(n.fontSize=Number(t)||16),this.graph.getDataModel().setStyle(this.selectedCell,n)})},clearGraph(){this.graph&&(this.graph.batchUpdate(()=>{const e=this.graph.getChildCells();this.graph.removeCells(e)}),this.selectedCell=null,this.fileName="",this.fileId=null),this.updateMiniMap(!0)},initCanvasAfterSave(){this.graph&&this.graph.batchUpdate(()=>{const e=this.graph.getChildCells();this.graph.removeCells(e)}),this.selectedCell=null,this.fileName="",this.fileId=null,this.nodeCounter=0,this.cellProperties={value:"",width:120,height:60,fillColor:"#E3F2FD",strokeColor:"#1976D2",strokeWidth:2,arcSize:10},this.updateMiniMap(!0)},saveFile(){const e=this.fileName.trim();if(e){if(this.graph)try{const t=this.getSavedFiles(),n=this.fileId;if(t.find(t=>t.name===e&&t.id!==n))return void this.$message.error("Êñá‰ª∂ÂêçÈáçÂ§çÔºåËØ∑ÈáçÊñ∞ËæìÂÖ•");const a=this.graph.getChildCells(),r={},o={cells:[],edges:[]};a.forEach(e=>{if(e.isVertex()){const t=e.getGeometry();r[e.getId()]=e,o.cells.push({id:e.getId(),value:e.getValue(),style:e.getStyle(),geometry:t?{x:t.x,y:t.y,width:t.width,height:t.height}:null,vertex:!0,zoom:this.graph.getView().getScale(),pan:this.graph.getView().getTranslate()})}}),a.forEach(e=>{if(e.isEdge&&e.isEdge())try{const t=e.getTerminal?e.getTerminal(!0):null,n=e.getTerminal?e.getTerminal(!1):null;o.cells.push({id:e.getId?e.getId():null,source:t&&t.getId?t.getId():null,target:n&&n.getId?n.getId():null,style:e.getStyle?e.getStyle():{},edge:!0})}catch(t){console.error("‰øùÂ≠òËæπÊó∂Âá∫Èîô:",t,e)}});const i=n||Date.now().toString(),l={id:i,name:e,saveTime:(new Date).toISOString(),data:o},s=t.findIndex(e=>e.id===i);s>=0?t[s]=l:t.push(l),localStorage.setItem("eletron_files",JSON.stringify(t)),this.fileId=i,this.$message.success("‰øùÂ≠òÊàêÂäüÔºÅ"),this.initCanvasAfterSave()}catch(e){console.error("‰øùÂ≠òÂ§±Ë¥•:",e),this.$message.error("‰øùÂ≠òÂ§±Ë¥•ÔºåËØ∑ÈáçËØï")}}else this.$message.warning("ËØ∑ËæìÂÖ•Êñá‰ª∂Âêç")},getSavedFiles(){try{const e=localStorage.getItem("eletron_files");return e?JSON.parse(e):[]}catch(e){return console.error("ËØªÂèñÊñá‰ª∂ÂàóË°®Â§±Ë¥•:",e),[]}},loadFileById(e){const t=this.getSavedFiles().find(t=>t.id===e);t&&this.loadFile(t)},loadFile(e){if(this.graph)try{this.graph.batchUpdate(()=>{const e=this.graph.getChildCells();this.graph.removeCells(e)});const t={},n=e.data;n.cells.forEach(e=>{if(e.vertex&&e.geometry){const n=this.graph.insertVertex({parent:this.graph.getDefaultParent(),id:e.id,value:e.value,position:[e.geometry.x,e.geometry.y],size:[e.geometry.width,e.geometry.height],style:e.style||{},zoom:e.zoom,pan:e.pan});t[e.id]=n}}),n.cells.forEach(e=>{if(e.edge&&e.source&&e.target){const n=t[e.source],a=t[e.target];n&&a&&this.graph.insertEdge({parent:this.graph.getDefaultParent(),id:e.id,source:n,target:a,style:e.style||{}})}}),this.fileName=e.name,this.fileId=e.id,this.centerGraphContent()}catch(e){console.error("Âä†ËΩΩÊñá‰ª∂Â§±Ë¥•:",e),alert("Âä†ËΩΩÊñá‰ª∂Â§±Ë¥•ÔºåËØ∑ÈáçËØï")}},handleKeyDown(e){this.handlePanKeyDown(e),this.handleDeleteKey(e)},handleGlobalKeyDown(e){this.handlePanKeyDown(e),this.handleDeleteKey(e)},handleGlobalKeyUp(e){"Space"===e.code&&(this.isSpacePressed=!1,this.updatePanningCursor())},handleDeleteKey(e){if("Delete"===e.key||"Backspace"===e.key){if("INPUT"===e.target.tagName||"TEXTAREA"===e.target.tagName)return;if(!this.graph)return;const t=this.graph.getSelectionCells();t.length>0&&(e.preventDefault(),e.stopPropagation(),this.graph.batchUpdate(()=>{this.graph.removeCells(t)}),this.selectedCell=null)}},handlePanKeyDown(e){if("Space"===e.code&&!this.isSpacePressed){const t=e.target,n=t&&t.tagName?t.tagName.toUpperCase():"";if("INPUT"===n||"TEXTAREA"===n||t.isContentEditable)return;e.preventDefault(),this.isSpacePressed=!0,this.updatePanningCursor()}},updatePanningCursor(){const e=this.$refs.graphContainer;e&&(this.isSpacePressed?e.classList.add("panning-mode"):e.classList.remove("panning-mode"))},updateMiniMap(e=!1){this.miniMap&&"function"==typeof this.miniMap.update&&this.$nextTick(()=>{this.miniMap?.update(e),this.adjustMiniMapViewport()})},centerGraphContent(){if(!this.graph)return;const e=this.graph.getGraphBounds();!e||0===e.width&&0===e.height||(this.graph.center(!0,!0),"function"==typeof this.graph.setPanDx&&this.graph.setPanDx(0),"function"==typeof this.graph.setPanDy&&this.graph.setPanDy(0),this.updateMiniMap(!0))},adjustMiniMapViewport(){if(!this.miniMap||!this.miniMap.selectionBorder)return;const e=this.miniMap.selectionBorder,t=e.bounds;if(!t||t.width<=0||t.height<=0)return;const n=Math.min(t.width,t.height),a=t.x+t.width/2,r=t.y+t.height/2,o=new l.A(a-n/2,r-n/2,n,n);e.bounds.width===o.width&&e.bounds.height===o.height&&e.bounds.x===o.x&&e.bounds.y===o.y||(e.bounds=o,e.redraw());const i=this.miniMap.sizer;if(i&&i.bounds){const e=i.bounds,t=new l.A(o.x+o.width-e.width/2,o.y+o.height-e.height/2,e.width,e.height);e.x===t.x&&e.y===t.y||(i.bounds=t,i.redraw())}}}};var p=n(5072),h=n.n(p),c=n(7825),g=n.n(c),u=n(7659),m=n.n(u),y=n(5056),f=n.n(y),b=n(540),v=n.n(b),x=n(1113),k=n.n(x),C=n(6822),w={};w.styleTagTransform=k(),w.setAttributes=f(),w.insert=m().bind(null,"head"),w.domAPI=g(),w.insertStyleElement=v(),h()(C.A,w),C.A&&C.A.locals&&C.A.locals;const S=(0,n(4486).A)(d,a,[],!1,null,"517d1468",null).exports},6822:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(1601),r=n.n(a),o=n(6314),i=n.n(o)()(r());i.push([e.id,"\n.eletron-page[data-v-517d1468] {\n  display: flex;\n  flex-direction: column;\n  height: calc(100vh - 120px);\n  padding: 0 0 20px 0;\n  color: var(--color-text-primary);\n  gap: 20px;\n}\n.toolbar[data-v-517d1468] {\n  margin-bottom: 20px;\n  background: linear-gradient(135deg, rgba(13, 28, 54, 0.92), rgba(12, 31, 62, 0.78));\n  border: 1px solid var(--color-border);\n  box-shadow: var(--shadow-elevated);\n}\n.toolbar h1[data-v-517d1468] {\n  margin: 0;\n  color: var(--color-text-primary);\n  font-size: 1.5rem;\n  letter-spacing: 0.08em;\n  text-transform: uppercase;\n}\n.toolbar-actions[data-v-517d1468] {\n  display: flex;\n  justify-content: flex-end;\n}\n.actions-wrapper[data-v-517d1468] {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  gap: 20px;\n  width: 100%;\n}\n.zoom-controls[data-v-517d1468] {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  padding: 6px 10px;\n  border-radius: 12px;\n  background: rgba(14, 27, 52, 0.65);\n  border: 1px solid rgba(56, 189, 248, 0.18);\n  box-shadow: inset 0 0 12px rgba(56, 189, 248, 0.08);\n}\n[data-v-517d1468] .zoom-controls .el-button {\n  background: linear-gradient(135deg, rgba(14, 94, 156, 0.9), rgba(8, 47, 121, 0.9));\n  border: 1px solid rgba(56, 189, 248, 0.35);\n  color: var(--color-text-primary);\n  box-shadow: 0 8px 18px rgba(56, 189, 248, 0.25);\n  transition: transform 0.2s ease, box-shadow 0.2s ease, background 0.2s ease;\n}\n[data-v-517d1468] .zoom-controls .el-button:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 12px 24px rgba(56, 189, 248, 0.35);\n  background: linear-gradient(135deg, rgba(24, 126, 198, 0.95), rgba(14, 63, 148, 0.95));\n}\n[data-v-517d1468] .zoom-controls .el-button:active {\n  transform: translateY(0);\n  box-shadow: 0 6px 16px rgba(56, 189, 248, 0.3);\n}\n[data-v-517d1468] .zoom-controls .el-button .el-icon {\n  color: var(--color-text-primary);\n}\n.zoom-level[data-v-517d1468] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  min-width: 48px;\n  text-align: right;\n}\n.file-controls[data-v-517d1468] {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n.file-controls .el-input[data-v-517d1468] {\n  width: 220px;\n}\n.main-content[data-v-517d1468] {\n  display: flex;\n  gap: 20px;\n  flex: 1;\n  min-height: 0;\n}\n.canvas-area[data-v-517d1468] {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n  position: relative;\n}\n.graph-container[data-v-517d1468] {\n  flex: 1;\n  background: radial-gradient(circle at 15% 20%, rgba(56, 189, 248, 0.12), rgba(12, 18, 36, 0.95)),\n              linear-gradient(180deg, rgba(5, 12, 26, 0.95), rgba(7, 14, 32, 0.85));\n  border: 1px solid rgba(56, 189, 248, 0.25);\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 18px 42px rgba(8, 47, 73, 0.35);\n  transition: border-color 0.3s ease, box-shadow 0.3s ease, transform 0.3s ease;\n  outline: none;\n}\n.graph-container[data-v-517d1468]:focus {\n  border-color: var(--color-accent);\n  box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.35), 0 20px 45px rgba(8, 47, 73, 0.4);\n  transform: translateY(-2px);\n}\n.graph-container.drag-over[data-v-517d1468] {\n  border-color: rgba(56, 189, 248, 0.9);\n  border-width: 2px;\n  box-shadow: 0 0 30px rgba(56, 189, 248, 0.45);\n  background: radial-gradient(circle at 50% 50%, rgba(56, 189, 248, 0.2), rgba(5, 12, 26, 0.95));\n}\n.graph-container.panning-mode[data-v-517d1468] {\n  cursor: grab;\n}\n.graph-container.panning-mode[data-v-517d1468]:active {\n  cursor: grabbing;\n}\n.canvas-overlay[data-v-517d1468] {\n  position: absolute;\n  display: flex;\n  pointer-events: none;\n  z-index: 10;\n}\n.canvas-overlay--left[data-v-517d1468] {\n  left: 18px;\n  bottom: 18px;\n}\n.canvas-overlay--right[data-v-517d1468] {\n  right: 18px;\n  bottom: 18px;\n  width: 200px;\n  height: 200px;\n  align-items: center;\n  justify-content: center;\n}\n.canvas-overlay > *[data-v-517d1468] {\n  pointer-events: auto;\n}\n.mini-map[data-v-517d1468] {\n  width: 180px;\n  height: 180px;\n  aspect-ratio: 1 / 1;\n  border-radius: 12px;\n  overflow: hidden;\n  border: 1px solid rgba(56, 189, 248, 0.25);\n  box-shadow: 0 10px 30px rgba(8, 47, 73, 0.4);\n  background: rgba(7, 15, 32, 0.85);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n[data-v-517d1468] .mini-map > * {\n  width: 100%;\n  height: 100%;\n}\n.sidebar[data-v-517d1468] {\n  width: 420px;\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n  min-width: 420px;\n  min-height: 0;\n  height: 100%;\n}\n.component-library[data-v-517d1468] {\n  flex: 1 1 0;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  background: linear-gradient(135deg, rgba(13, 24, 45, 0.9), rgba(12, 32, 59, 0.78));\n  border: 1px solid var(--color-border);\n  box-shadow: var(--shadow-elevated);\n}\n[data-v-517d1468] .component-library .el-card__body {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  padding: 15px;\n  overflow: hidden;\n}\n.component-library h3[data-v-517d1468] {\n  margin: 0;\n  color: var(--color-text-primary);\n  font-size: 1.1rem;\n  letter-spacing: 0.06em;\n  text-transform: uppercase;\n}\n.component-list[data-v-517d1468] {\n  overflow-y: auto;\n  flex: 1;\n  margin-top: 10px;\n  padding-right: 4px;\n  scrollbar-color: rgba(56, 189, 248, 0.4) rgba(14, 25, 48, 0.2);\n}\n.component-item[data-v-517d1468] {\n  cursor: pointer;\n  margin-bottom: 10px;\n  height: 120px;\n  background: rgba(11, 26, 52, 0.82);\n  border: 1px solid transparent;\n  transition: transform 0.25s ease, border-color 0.25s ease, box-shadow 0.25s ease;\n  color: var(--color-text-primary);\n}\n.component-item[data-v-517d1468]:hover {\n  transform: translateY(-4px);\n  border-color: var(--color-border);\n  box-shadow: 0 16px 28px rgba(8, 47, 73, 0.35);\n}\n.component-content[data-v-517d1468] {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 10px;\n  height: 100%;\n  justify-content: center;\n  gap: 6px;\n}\n.component-icon[data-v-517d1468] {\n  width: 50px;\n  height: 50px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 24px;\n  border-radius: 8px;\n  margin-bottom: 8px;\n  border: 1px solid rgba(255, 255, 255, 0.08);\n  box-shadow: 0 6px 18px rgba(56, 189, 248, 0.25);\n}\n.component-name[data-v-517d1468] {\n  font-size: 0.85rem;\n  color: var(--color-text-secondary);\n  text-align: center;\n  /* ÊúÄÂ§ö‰∏ÄË°åÊòæÁ§∫15‰∏™Â≠óÁ¨¶ÔºåË∂ÖËøáÊç¢Ë°å */\n  width: 15ch;\n  min-width: 5ch;\n  white-space: normal;\n  word-break: break-all;\n  line-height: 1.2;\n}\n\n/* ËÆ© el-card Â°´Êª°Âõ∫ÂÆöÈ´òÂ∫¶Ôºå‰øùËØÅÊâÄÊúâÂÖÉÂô®Â§ßÂ∞è‰∏ÄËá¥ */\n[data-v-517d1468] .component-item .el-card__body {\n  height: 100%;\n  padding: 10px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: transparent;\n}\n.property-panel[data-v-517d1468] {\n  flex: 1 1 0;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  background: linear-gradient(135deg, rgba(16, 27, 50, 0.9), rgba(10, 24, 47, 0.78));\n  border: 1px solid var(--color-border);\n  box-shadow: var(--shadow-elevated);\n}\n[data-v-517d1468] .property-panel .el-card__body {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  padding: 15px;\n  min-height: 0;\n  background: transparent;\n}\n.property-panel h3[data-v-517d1468] {\n  margin: 0;\n  color: var(--color-text-primary);\n  font-size: 1.1rem;\n  letter-spacing: 0.06em;\n  text-transform: uppercase;\n}\n.property-panel .el-form[data-v-517d1468] {\n  overflow-y: auto;\n  flex: 1;\n  padding-right: 4px;\n  min-height: 0;\n  scrollbar-color: rgba(56, 189, 248, 0.4) rgba(14, 25, 48, 0.2);\n}\n[data-v-517d1468] .el-input__inner,[data-v-517d1468] .el-input-number__decrease,[data-v-517d1468] .el-input-number__increase,[data-v-517d1468] .el-select .el-input__inner {\n  background: rgba(9, 20, 41, 0.85);\n  border: 1px solid rgba(56, 189, 248, 0.2);\n  color: var(--color-text-primary);\n}\n[data-v-517d1468] .el-input-number__decrease,[data-v-517d1468] .el-input-number__increase {\n  color: var(--color-text-secondary);\n}\n[data-v-517d1468] .el-divider__text,[data-v-517d1468] .el-form-item__label {\n  color: var(--color-text-secondary);\n}\n[data-v-517d1468] .el-empty__description {\n  color: var(--color-text-secondary);\n}\n[data-v-517d1468] .el-button--primary {\n  background: linear-gradient(135deg, rgba(56, 189, 248, 0.92), rgba(59, 130, 246, 0.85));\n  border: none;\n  box-shadow: 0 10px 28px rgba(56, 189, 248, 0.35);\n}\n[data-v-517d1468] .el-button--danger {\n  background: linear-gradient(135deg, rgba(248, 113, 113, 0.92), rgba(239, 68, 68, 0.75));\n  border: none;\n  box-shadow: 0 10px 24px rgba(248, 113, 113, 0.32);\n}\n[data-v-517d1468] .component-list::-webkit-scrollbar,[data-v-517d1468] .property-panel .el-form::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n[data-v-517d1468] .component-list::-webkit-scrollbar-track,[data-v-517d1468] .property-panel .el-form::-webkit-scrollbar-track {\n  background: rgba(14, 25, 48, 0.35);\n  border-radius: 999px;\n}\n[data-v-517d1468] .component-list::-webkit-scrollbar-thumb,[data-v-517d1468] .property-panel .el-form::-webkit-scrollbar-thumb {\n  background: rgba(56, 189, 248, 0.45);\n  border-radius: 999px;\n  border: 1px solid rgba(56, 189, 248, 0.45);\n  box-shadow: 0 0 12px rgba(56, 189, 248, 0.25);\n}\n",""]);const l=i}}]);